library(DESeq2)uninfected1 = read.table("uninfected1_abundance.tsv", header = T, sep = "\t")uninfected2 = read.table("uninfected2_abundance.tsv", header = T, sep = "\t")infected = read.table("infected_abundance.tsv", header = T, sep = "\t")uninfected = merge(uninfected1,uninfected2, by = "target_id", all = T)all = merge(uninfected,infected, by="target_id", all = T)row.names(all) = all$target_idcounts = all[, c(4,8,12)]names(counts) = c('uninfected1', 'uninfected2', 'infected')counts = round(counts)samples = data.frame('group' = c('uninfected', 'uninfected', 'infected'), row.names = c('uninfected1', 'uninfected2', 'infected'))dds = DESeqDataSetFromMatrix(counts,samples, design = ~group)dds = DESeq(dds)Infected_vs_Uninfected = results(dds, contrast = c('group', 'infected', 'uninfected'))head(Infected_vs_Uninfected)Infected_vs_Uninfected_copy = results(dds, contrast = c('group', 'infected', 'uninfected'))Infected_vs_Uninfected_copy$padj[is.na(Infected_vs_Uninfected_copy$padj)] = 1Infected_vs_Uninfected_padj = Infected_vs_Uninfected_copy[Infected_vs_Uninfected_copy$padj<0.05,]head(Infected_vs_Uninfected_padj)#volcano plotInfected_vs_Uninfected$nlog10padj = -log10(Infected_vs_Uninfected$padj)plot(Infected_vs_Uninfected$log2FoldChange, Infected_vs_Uninfected$nlog10padj,      xlab = "log2(Infected/Uninfected)",      ylab = "-log10(padj)",      main = 'Yanwen Wang',      col = 'grey',      sub='padj<0.05')abline(h=-log10(0.05), col = 'blue')points(Infected_vs_Uninfected_padj$log2FoldChange, -log10(Infected_vs_Uninfected_padj$padj), col ='red')text(Infected_vs_Uninfected$log2FoldChange[rownames(Infected_vs_Uninfected)== "NM_002038"],      0.5+Infected_vs_Uninfected$nlog10padj[rownames(Infected_vs_Uninfected) == "NM_002038"],      label = "IFI6",      col ='black')points(Infected_vs_Uninfected$log2FoldChange[rownames(Infected_vs_Uninfected)== "NM_002038"],        Infected_vs_Uninfected$nlog10padj[rownames(Infected_vs_Uninfected) == "NM_002038"],        col = 'black')library('gplots')library('viridis')#heatmap 1tpm = all[,c(5,9,13)]names(tpm) = c('uninfected1', 'uninfected2', 'infected')row.names(tpm) = all$target_idtpm_log2 = log2(tpm+0.5)significant_genes = rownames(Infected_vs_Uninfected_padj)tpm_diff_exp = tpm_log2[rownames(tpm_log2) %in% significant_genes, ]par (oma = c(5,2,1,2))heatmap.2(as.matrix(tpm_diff_exp),          col = viridis(50),          scale = c('none'),          margins = c(1,1),          cexCol = 1,          symkey =F,          symbreak = F,          trace = 'none',          density.info = 'none',          Rowv = T,          Colv = T,          dendrogram = 'both',          labRow = F,          key = T,          keysize = 2,          key.title = '',          key.xlab = 'log2 TPM',          main = 'Yanwen Wang')#heatmap 2log2foldchange = Infected_vs_Uninfected_padj$log2FoldChangelog2foldchange_matrix = matrix(rep(log2foldchange,2), ncol = 2, byrow = F)row.names(log2foldchange_matrix) = row.names(Infected_vs_Uninfected_padj)colnames(log2foldchange_matrix) = c("log2 Fold Change", 'log2 Fold Change Copy')heatmap.2(log2foldchange_matrix,          col = viridis(50, option = "D"),          margin = c(8, 8),          cexCol = 1,          scale = 'none',          symkey = T,          trace = 'none',          density.info = 'none',          Rowv = T,          dendrogram = 'none',          labRow = F,          key = T,          key.title = '',          key.xlab = 'log2 Fold Change (Infected/Uninfected)',          main = 'Yanwen Wang')#downregulateddregulated = Infected_vs_Uninfected_padj[order(Infected_vs_Uninfected_padj$log2FoldChange, Infected_vs_Uninfected_padj$padj), ]head(dregulated)#upregulateduregulated = Infected_vs_Uninfected_padj[order(-Infected_vs_Uninfected_padj$log2FoldChange, Infected_vs_Uninfected_padj$padj), ]head(uregulated)